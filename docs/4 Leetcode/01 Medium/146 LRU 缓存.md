#æ¨¡æ‹Ÿ

![](FigureBed%20ğŸŒ„/Pasted/Pasted%20image%2020220610102909.png)
[c++é¢˜è§£](https://leetcode.cn/problems/lru-cache/solution/146-lru-huan-cun-ji-zhi-cxiang-xi-ti-jie-ulv8/)

- åªå†™ä¸¤ä¸ªå›è°ƒå‡½æ•° `remove` å’Œ `delete`
---
`get(key)ï¼š`
**é¦–å…ˆç”¨å“ˆå¸Œè¡¨åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ï¼š**
- å¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1ï¼›
- å¦‚æœkeyå­˜åœ¨ï¼Œåˆ™è¿”å›å¯¹åº”çš„valueï¼ŒåŒæ—¶å°†keyå¯¹åº”çš„èŠ‚ç‚¹æ”¾åˆ°åŒé“¾è¡¨çš„æœ€å·¦ä¾§ï¼›`remove(); insert();`

`put(key, value)ï¼š`
**é¦–å…ˆç”¨å“ˆå¸Œè¡¨åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ï¼š**
- å¦‚æœkeyå­˜åœ¨ï¼Œåˆ™ä¿®æ”¹å¯¹åº”çš„valueï¼ŒåŒæ—¶å°†keyå¯¹åº”çš„èŠ‚ç‚¹æ”¾åˆ°åŒé“¾è¡¨çš„æœ€å·¦ä¾§ï¼›`remove(); insert();`
- å¦‚æœkeyä¸å­˜åœ¨ï¼š<mark style="background: #ABF7F7A6;">å°¤å…¶è¦æ³¨æ„æ›´æ–°å“ˆå¸Œè¡¨</mark> 
	- å¦‚æœç¼“å­˜å·²æ»¡ï¼Œåˆ™åˆ é™¤åŒé“¾è¡¨æœ€å³ä¾§çš„èŠ‚ç‚¹ï¼ˆä¸Šæ¬¡ä½¿ç”¨æ—¶é—´æœ€è€çš„èŠ‚ç‚¹ï¼‰ï¼Œ<mark style="background: #ABF7F7A6;">æ›´æ–°å“ˆå¸Œè¡¨ï¼›</mark> 
	- å¦åˆ™ï¼Œæ’å…¥(key, value)ï¼šåŒæ—¶å°†keyå¯¹åº”çš„èŠ‚ç‚¹æ”¾åˆ°åŒé“¾è¡¨çš„æœ€å·¦ä¾§ï¼Œ<mark style="background: #ABF7F7A6;">æ›´æ–°å“ˆå¸Œè¡¨ï¼›</mark> 

```cpp
//
// Created by sync on 2022/6/9.
//

# include <vector>
# include <unordered_map>

using namespace std;

struct Node{
    int key, val;
    Node* left;
    Node* right;

    Node(): key(0), val(0), left(nullptr), right(nullptr) {}
    Node(int _key, int _val): key(_key), val(_val), left(nullptr), right(nullptr) {}
};

class LRUCache{
private:
    unordered_map<int, Node*> cache;
    int capacity;
    int size;
    Node* head;
    Node* tail;
public:

    LRUCache(int _capacity){
        capacity = _capacity;
        size = 0;

        head = new Node();
        tail = new Node();

        head->right = tail;
        tail->left = head;
    }

    int get(int key){
        if(cache.find(key) == cache.end()) return -1;

        auto addr = cache[key];

        // update LinkList
        remove(addr);
        insert(addr);

        return addr->val;
    }

    void put(int key, int value){
        if(cache.find(key) != cache.end()){
            auto addr = cache[key];

            // update LinkList
            remove(addr);
            insert(addr);

            addr->val = value;
        }else{
            size++;
            if(size > capacity){
                auto lastNode = tail->left;
                remove(lastNode);
                cache.erase(lastNode->key);
                delete lastNode;
                size--;
            }

            auto newNode = new Node(key, value);
            insert(newNode);
            cache[key] = newNode; // æ€»æ˜¯ä¼šå¿˜è®°
        }
    }

    void remove(Node* addr){
        addr->left->right = addr->right;
        addr->right->left = addr->left;
    }

    void insert(Node* addr){
        addr->left = head;
        addr->right = head->right;

        head->right->left = addr;
        head->right = addr;
    }

};
```
